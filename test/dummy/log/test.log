  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_contact_relationships"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_contacts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contacts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "address" varchar, "birth_date" date, "city" varchar, "company" varchar, "country" varchar, "created_at" datetime(6) NOT NULL, "email" varchar, "job_title" varchar, "name" varchar, "notes" text, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_phones_on_contact_id" ON "aeno_phones" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_related_contact_id" ON "aaeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_contact_id" ON "aaeno_contact_relationships" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_cc579d9ac6"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aaeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_contact_relationships"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_related_contact_id" ON "aaeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_contact_id" ON "aaeno_contact_relationships" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_cc579d9ac6"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
, CONSTRAINT "fk_rails_4036425e42"
FOREIGN KEY ("related_contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aaeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_contact_relationships"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_phones_on_contact_id" ON "aaeno_phones" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_phones" ("id","contact_id","created_at","number","phone_type","updated_at")
                     SELECT "id","contact_id","created_at","number","phone_type","updated_at" FROM "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_ef5e496490"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_phones_on_contact_id" ON "aeno_phones" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("id","contact_id","created_at","number","phone_type","updated_at")
                     SELECT "id","contact_id","created_at","number","phone_type","updated_at" FROM "aaeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_phones"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251219100003)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251219100002),
(20251219100001);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-12-19 09:02:38.551229', '2025-12-19 09:02:38.551230') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ccdce04ebe1d9e75210e67079c18dcbb9c886cd4', '2025-12-19 09:02:38.551791', '2025-12-19 09:02:38.551791') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_contact_relationships"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_contacts"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "aeno_contacts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "address" varchar, "birth_date" date, "city" varchar, "company" varchar, "country" varchar, "created_at" datetime(6) NOT NULL, "email" varchar, "job_title" varchar, "name" varchar, "notes" text, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_phones_on_contact_id" ON "aeno_phones" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_related_contact_id" ON "aaeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_contact_id" ON "aaeno_contact_relationships" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aeno_contact_relationships"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_cc579d9ac6"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aaeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_contact_relationships"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_related_contact_id" ON "aaeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_contact_id" ON "aaeno_contact_relationships" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_cc579d9ac6"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
, CONSTRAINT "fk_rails_4036425e42"
FOREIGN KEY ("related_contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aaeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_contact_relationships"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_phones_on_contact_id" ON "aaeno_phones" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_phones" ("id","contact_id","created_at","number","phone_type","updated_at")
                     SELECT "id","contact_id","created_at","number","phone_type","updated_at" FROM "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_ef5e496490"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_phones_on_contact_id" ON "aeno_phones" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("id","contact_id","created_at","number","phone_type","updated_at")
                     SELECT "id","contact_id","created_at","number","phone_type","updated_at" FROM "aaeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_phones"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251219100003)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251219100002),
(20251219100001);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-12-19 09:02:45.012605', '2025-12-19 09:02:45.012605') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ccdce04ebe1d9e75210e67079c18dcbb9c886cd4', '2025-12-19 09:02:45.012907', '2025-12-19 09:02:45.012907') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
--------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_accept_phones_as_array_instead_of_keyed_hash
--------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.2ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.058905"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.058905"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:02:45 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Array Test", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-ARR-1", "phone_type" => "mobile"}, {"number" => "555-ARR-2", "phone_type" => "work"}]}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Array Test", "email" => "array@example.com", "phones_attributes" => [{"number" => "555-ARR-1", "phone_type" => "mobile"}, {"number" => "555-ARR-2", "phone_type" => "work"}]}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.2ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.110425"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Array Test"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.110425"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.110957"], ["number", "555-ARR-1"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.110957"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.111155"], ["number", "555-ARR-2"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:02:45.111155"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 0
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 2
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 17ms (ActiveRecord: 0.6ms (5 queries, 0 cached) | GC: 0.3ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Array Test"], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? ORDER BY "aeno_phones"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_accept_deeply_nested_arrays
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.116810"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.116810"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:02:45 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Deep Array Test", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-MAIN", "phone_type" => "mobile"}], "contact_relationships_attributes" => [{"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Sibling Array", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-SIB-1", "phone_type" => "work"}, {"number" => "555-SIB-2", "phone_type" => "mobile"}]}}, {"relation_type" => "friend", "related_contact_attributes" => {"name" => "Friend Array", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-FRD", "phone_type" => "mobile"}]}}]}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Deep Array Test", "email" => "deeparray@example.com", "phones_attributes" => [{"number" => "555-MAIN", "phone_type" => "mobile"}], "contact_relationships_attributes" => [{"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Sibling Array", "email" => "sibarray@example.com", "phones_attributes" => [{"number" => "555-SIB-1", "phone_type" => "work"}, {"number" => "555-SIB-2", "phone_type" => "mobile"}]}}, {"relation_type" => "friend", "related_contact_attributes" => {"name" => "Friend Array", "email" => "friendarray@example.com", "phones_attributes" => [{"number" => "555-FRD", "phone_type" => "mobile"}]}}]}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.120489"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Deep Array Test"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.120489"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.120838"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Sibling Array"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.120838"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:02:45.121027"], ["number", "555-SIB-1"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:02:45.121027"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:02:45.121179"], ["number", "555-SIB-2"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.121179"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.121310"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:02:45.121310"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.121491"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Friend Array"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.121491"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 4], ["created_at", "2025-12-19 09:02:45.121671"], ["number", "555-FRD"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.121671"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.121799"], ["related_contact_id", 4], ["relation_type", "friend"], ["updated_at", "2025-12-19 09:02:45.121799"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.121964"], ["number", "555-MAIN"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.121964"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 2
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 1
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 5ms (ActiveRecord: 0.3ms (11 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Deep Array Test"], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mCACHE Aeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."relation_type" = ? LIMIT ?[0m  [["contact_id", 2], ["relation_type", "sibling"], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."relation_type" = ? LIMIT ?[0m  [["contact_id", 2], ["relation_type", "friend"], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_destroy_nested_relationships_with__destroy_flag
-----------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.124481"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.124481"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.124777"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "ToDelete"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.124777"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 1], ["created_at", "2025-12-19 09:02:45.125152"], ["related_contact_id", 2], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:02:45.125152"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
Started PATCH "/contacts/1" for 127.0.0.1 at 2025-12-19 10:02:45 +0100
Processing by ContactsController#update as HTML
  Parameters: {"contact" => {"contact_relationships_attributes" => {"0" => {"id" => "1", "_destroy" => "1"}}}, "id" => "1"}
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
================================================================================
UPDATE PARAMS:
{"contact" => {"contact_relationships_attributes" => {"0" => {"id" => "1", "_destroy" => "1"}}}, "controller" => "contacts", "action" => "update", "id" => "1"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Load (0.1ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."id" = ?[0m  [["contact_id", 1], ["id", 1]]
  [1m[36mAeno::ContactRelationship Destroy (0.0ms)[0m  [1m[31mDELETE FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."id" = ?[0m  [["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact updated
Redirected to http://www.example.com/contacts/1
Completed 302 Found in 1ms (ActiveRecord: 0.1ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_create_contact_with_nested_relationships_and_phones
---------------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.127957"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.127957"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts"[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones"[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:02:45 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Jane Smith", "email" => "[FILTERED]", "phones_attributes" => {"0" => {"number" => "555-0001", "phone_type" => "mobile"}}, "contact_relationships_attributes" => {"0" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Bob Smith", "email" => "[FILTERED]", "phones_attributes" => {"0" => {"number" => "555-0002", "phone_type" => "work"}}}}}}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Jane Smith", "email" => "jane@example.com", "phones_attributes" => {"0" => {"number" => "555-0001", "phone_type" => "mobile"}}, "contact_relationships_attributes" => {"0" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Bob Smith", "email" => "bob@example.com", "phones_attributes" => {"0" => {"number" => "555-0002", "phone_type" => "work"}}}}}}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.129809"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Jane Smith"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.129809"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.130037"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Bob Smith"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.130037"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:02:45.130211"], ["number", "555-0002"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:02:45.130211"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.130338"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:02:45.130338"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.130491"], ["number", "555-0001"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.130491"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 1
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 1
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 2ms (ActiveRecord: 0.2ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones"[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts"[0m
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Jane Smith"], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? ORDER BY "aeno_phones"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? ORDER BY "aeno_contact_relationships"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? ORDER BY "aeno_phones"."id" ASC LIMIT ?[0m  [["contact_id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_update_contact_with_nested_relationships
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.132682"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.132682"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.132966"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Alice"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.132966"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 1], ["created_at", "2025-12-19 09:02:45.133328"], ["related_contact_id", 2], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:02:45.133328"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.133646"], ["number", "555-0003"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.133646"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/contacts/1" for 127.0.0.1 at 2025-12-19 10:02:45 +0100
Processing by ContactsController#update as HTML
  Parameters: {"contact" => {"name" => "John Updated", "contact_relationships_attributes" => {"0" => {"id" => "1", "relation_type" => "friend", "related_contact_attributes" => {"id" => "2", "name" => "Alice Updated", "phones_attributes" => {"0" => {"id" => "1", "number" => "555-UPDATED"}}}}}}, "id" => "1"}
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
================================================================================
UPDATE PARAMS:
{"contact" => {"name" => "John Updated", "contact_relationships_attributes" => {"0" => {"id" => "1", "relation_type" => "friend", "related_contact_attributes" => {"id" => "2", "name" => "Alice Updated", "phones_attributes" => {"0" => {"id" => "1", "number" => "555-UPDATED"}}}}}}, "controller" => "contacts", "action" => "update", "id" => "1"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."id" = ?[0m  [["contact_id", 1], ["id", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? AND "aeno_phones"."id" = ?[0m  [["contact_id", 2], ["id", 1]]
  [1m[36mAeno::Contact Update (0.0ms)[0m  [1m[33mUPDATE "aeno_contacts" SET "name" = ?, "updated_at" = ? WHERE "aeno_contacts"."id" = ?[0m  [["name", "John Updated"], ["updated_at", "2025-12-19 09:02:45.135449"], ["id", 1]]
  [1m[36mAeno::Contact Update (0.0ms)[0m  [1m[33mUPDATE "aeno_contacts" SET "name" = ?, "updated_at" = ? WHERE "aeno_contacts"."id" = ?[0m  [["name", "Alice Updated"], ["updated_at", "2025-12-19 09:02:45.135699"], ["id", 2]]
  [1m[36mAeno::Phone Update (0.0ms)[0m  [1m[33mUPDATE "aeno_phones" SET "number" = ?, "updated_at" = ? WHERE "aeno_phones"."id" = ?[0m  [["number", "555-UPDATED"], ["updated_at", "2025-12-19 09:02:45.135859"], ["id", 1]]
  [1m[36mAeno::ContactRelationship Update (0.0ms)[0m  [1m[33mUPDATE "aeno_contact_relationships" SET "relation_type" = ?, "updated_at" = ? WHERE "aeno_contact_relationships"."id" = ?[0m  [["relation_type", "friend"], ["updated_at", "2025-12-19 09:02:45.135990"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact updated
Redirected to http://www.example.com/contacts/1
Completed 302 Found in 2ms (ActiveRecord: 0.2ms (8 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
--------------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_handle_deeply_nested_structure_with_timestamp_keys
--------------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.137189"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.137189"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:02:45 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Test Contact", "email" => "[FILTERED]", "contact_relationships_attributes" => {"1234567890" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Related Contact", "phones_attributes" => {"9876543210" => {"number" => "555-1111", "phone_type" => "mobile"}, "9876543211" => {"number" => "555-2222", "phone_type" => "work"}}}}}}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Test Contact", "email" => "test@example.com", "contact_relationships_attributes" => {"1234567890" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Related Contact", "phones_attributes" => {"9876543210" => {"number" => "555-1111", "phone_type" => "mobile"}, "9876543211" => {"number" => "555-2222", "phone_type" => "work"}}}}}}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.138646"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Test Contact"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.138646"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:02:45.138873"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Related Contact"], ["notes", nil], ["updated_at", "2025-12-19 09:02:45.138873"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:02:45.139049"], ["number", "555-1111"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:02:45.139049"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:02:45.139192"], ["number", "555-2222"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:02:45.139192"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:02:45.139312"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:02:45.139312"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 1
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 0
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 2ms (ActiveRecord: 0.2ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Test Contact"], ["LIMIT", 1]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? ORDER BY "aeno_contact_relationships"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_contact_relationships"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_contacts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contacts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "address" varchar, "birth_date" date, "city" varchar, "company" varchar, "country" varchar, "created_at" datetime(6) NOT NULL, "email" varchar, "job_title" varchar, "name" varchar, "notes" text, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_phones_on_contact_id" ON "aeno_phones" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_related_contact_id" ON "aaeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_contact_id" ON "aaeno_contact_relationships" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aeno_contact_relationships"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_cc579d9ac6"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aaeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_contact_relationships"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_related_contact_id" ON "aaeno_contact_relationships" ("related_contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_contact_relationships_on_contact_id" ON "aaeno_contact_relationships" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_contact_relationships" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "related_contact_id" integer NOT NULL, "relation_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_cc579d9ac6"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
, CONSTRAINT "fk_rails_4036425e42"
FOREIGN KEY ("related_contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_contact_id" ON "aeno_contact_relationships" ("contact_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_contact_relationships_on_related_contact_id" ON "aeno_contact_relationships" ("related_contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("id","contact_id","created_at","related_contact_id","relation_type","updated_at")
                     SELECT "id","contact_id","created_at","related_contact_id","relation_type","updated_at" FROM "aaeno_contact_relationships"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_contact_relationships"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aaeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "tindex_aaeno_phones_on_contact_id" ON "aaeno_phones" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aaeno_phones" ("id","contact_id","created_at","number","phone_type","updated_at")
                     SELECT "id","contact_id","created_at","number","phone_type","updated_at" FROM "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "aeno_phones" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "contact_id" integer NOT NULL, "created_at" datetime(6) NOT NULL, "number" varchar, "phone_type" varchar, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_ef5e496490"
FOREIGN KEY ("contact_id")
  REFERENCES "aeno_contacts" ("id")
)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_aeno_phones_on_contact_id" ON "aeno_phones" ("contact_id")[0m
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("id","contact_id","created_at","number","phone_type","updated_at")
                     SELECT "id","contact_id","created_at","number","phone_type","updated_at" FROM "aaeno_phones"[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE "aaeno_phones"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mCOMMIT TRANSACTION[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251219100003)[0m
  [1m[35m (0.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251219100002),
(20251219100001);[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-12-19 09:06:57.319589', '2025-12-19 09:06:57.319590') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ccdce04ebe1d9e75210e67079c18dcbb9c886cd4', '2025-12-19 09:06:57.319925', '2025-12-19 09:06:57.319926') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
------------------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_create_related_contacts_directly_without_relation_type
------------------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.5ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.367444"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.367444"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts"[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Main Contact", "email" => "[FILTERED]", "related_contacts_attributes" => {"1766135001" => {"name" => "Related One", "email" => "[FILTERED]", "phones_attributes" => {"1766135002" => {"number" => "555-REL1", "phone_type" => "mobile"}}}, "1766135003" => {"name" => "Related Two", "email" => "[FILTERED]"}}}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Main Contact", "email" => "main@example.com", "related_contacts_attributes" => {"1766135001" => {"name" => "Related One", "email" => "related1@example.com", "phones_attributes" => {"1766135002" => {"number" => "555-REL1", "phone_type" => "mobile"}}}, "1766135003" => {"name" => "Related Two", "email" => "related2@example.com"}}}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.2ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.426566"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Main Contact"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.426566"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.427109"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Related One"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.427109"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:06:57.427355"], ["number", "555-REL1"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.427355"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.428765"], ["related_contact_id", 3], ["relation_type", nil], ["updated_at", "2025-12-19 09:06:57.428765"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.428958"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Related Two"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.428958"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.429277"], ["related_contact_id", 4], ["relation_type", nil], ["updated_at", "2025-12-19 09:06:57.429277"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 2
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 0
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 20ms (ActiveRecord: 0.6ms (8 queries, 0 cached) | GC: 0.2ms)
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts"[0m
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Main Contact"], ["LIMIT", 1]]
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts" INNER JOIN "aeno_contact_relationships" ON "aeno_contacts"."id" = "aeno_contact_relationships"."related_contact_id" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mCACHE Aeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" INNER JOIN "aeno_contact_relationships" ON "aeno_contacts"."id" = "aeno_contact_relationships"."related_contact_id" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contacts"."name" = ? LIMIT ?[0m  [["contact_id", 2], ["name", "Related One"], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_create_contact_with_nested_relationships_and_phones
---------------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.435426"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.435426"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts"[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones"[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Jane Smith", "email" => "[FILTERED]", "phones_attributes" => {"0" => {"number" => "555-0001", "phone_type" => "mobile"}}, "contact_relationships_attributes" => {"0" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Bob Smith", "email" => "[FILTERED]", "phones_attributes" => {"0" => {"number" => "555-0002", "phone_type" => "work"}}}}}}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Jane Smith", "email" => "jane@example.com", "phones_attributes" => {"0" => {"number" => "555-0001", "phone_type" => "mobile"}}, "contact_relationships_attributes" => {"0" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Bob Smith", "email" => "bob@example.com", "phones_attributes" => {"0" => {"number" => "555-0002", "phone_type" => "work"}}}}}}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.437966"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Jane Smith"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.437966"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.438303"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Bob Smith"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.438303"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:06:57.438495"], ["number", "555-0002"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:06:57.438495"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.438637"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:06:57.438637"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.438795"], ["number", "555-0001"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.438795"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 1
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 1
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 3ms (ActiveRecord: 0.2ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones"[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts"[0m
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Jane Smith"], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? ORDER BY "aeno_phones"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? ORDER BY "aeno_contact_relationships"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? ORDER BY "aeno_phones"."id" ASC LIMIT ?[0m  [["contact_id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
--------------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_handle_deeply_nested_structure_with_timestamp_keys
--------------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.441563"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.441563"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Test Contact", "email" => "[FILTERED]", "contact_relationships_attributes" => {"1234567890" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Related Contact", "phones_attributes" => {"9876543210" => {"number" => "555-1111", "phone_type" => "mobile"}, "9876543211" => {"number" => "555-2222", "phone_type" => "work"}}}}}}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Test Contact", "email" => "test@example.com", "contact_relationships_attributes" => {"1234567890" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Related Contact", "phones_attributes" => {"9876543210" => {"number" => "555-1111", "phone_type" => "mobile"}, "9876543211" => {"number" => "555-2222", "phone_type" => "work"}}}}}}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.444390"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Test Contact"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.444390"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.444752"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Related Contact"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.444752"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:06:57.444967"], ["number", "555-1111"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.444967"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:06:57.445186"], ["number", "555-2222"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:06:57.445186"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.445331"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:06:57.445331"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 1
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 0
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 4ms (ActiveRecord: 0.3ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Test Contact"], ["LIMIT", 1]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? ORDER BY "aeno_contact_relationships"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
--------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_accept_phones_as_array_instead_of_keyed_hash
--------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.447709"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.447709"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Array Test", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-ARR-1", "phone_type" => "mobile"}, {"number" => "555-ARR-2", "phone_type" => "work"}]}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Array Test", "email" => "array@example.com", "phones_attributes" => [{"number" => "555-ARR-1", "phone_type" => "mobile"}, {"number" => "555-ARR-2", "phone_type" => "work"}]}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.2ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.450192"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Array Test"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.450192"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.450633"], ["number", "555-ARR-1"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.450633"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.450798"], ["number", "555-ARR-2"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:06:57.450798"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 0
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 2
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 3ms (ActiveRecord: 0.3ms (5 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Array Test"], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? ORDER BY "aeno_phones"."id" ASC LIMIT ?[0m  [["contact_id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_destroy_nested_relationships_with__destroy_flag
-----------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.452653"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.452653"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.452945"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "ToDelete"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.452945"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 1], ["created_at", "2025-12-19 09:06:57.453328"], ["related_contact_id", 2], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:06:57.453328"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
Started PATCH "/contacts/1" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#update as HTML
  Parameters: {"contact" => {"contact_relationships_attributes" => {"0" => {"id" => "1", "_destroy" => "1"}}}, "id" => "1"}
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
================================================================================
UPDATE PARAMS:
{"contact" => {"contact_relationships_attributes" => {"0" => {"id" => "1", "_destroy" => "1"}}}, "controller" => "contacts", "action" => "update", "id" => "1"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."id" = ?[0m  [["contact_id", 1], ["id", 1]]
  [1m[36mAeno::ContactRelationship Destroy (0.0ms)[0m  [1m[31mDELETE FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."id" = ?[0m  [["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact updated
Redirected to http://www.example.com/contacts/1
Completed 302 Found in 1ms (ActiveRecord: 0.1ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships"[0m
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
-----------------------------------------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_accept_mixed_direct_related_contacts_and_explicit_contact_relationships
-----------------------------------------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.456131"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.456131"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Mixed Contact", "email" => "[FILTERED]", "related_contacts_attributes" => {"1766135010" => {"name" => "Direct Related", "email" => "[FILTERED]"}}, "contact_relationships_attributes" => {"1766135011" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Explicit Sibling", "email" => "[FILTERED]"}}}}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Mixed Contact", "email" => "mixed@example.com", "related_contacts_attributes" => {"1766135010" => {"name" => "Direct Related", "email" => "direct@example.com"}}, "contact_relationships_attributes" => {"1766135011" => {"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Explicit Sibling", "email" => "sibling@example.com"}}}}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.457796"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Mixed Contact"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.457796"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.458045"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Explicit Sibling"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.458045"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.458205"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:06:57.458205"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.458348"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Direct Related"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.458348"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.458734"], ["related_contact_id", 4], ["relation_type", nil], ["updated_at", "2025-12-19 09:06:57.458734"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 2
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 0
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 3ms (ActiveRecord: 0.2ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Mixed Contact"], ["LIMIT", 1]]
  [1m[36mAeno::Contact Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contacts" INNER JOIN "aeno_contact_relationships" ON "aeno_contacts"."id" = "aeno_contact_relationships"."related_contact_id" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."relation_type" IS NULL[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."relation_type" = ?[0m  [["contact_id", 2], ["relation_type", "sibling"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
----------------------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_update_contact_with_nested_relationships
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.460256"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.460256"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.460533"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Alice"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.460533"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 1], ["created_at", "2025-12-19 09:06:57.460902"], ["related_contact_id", 2], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:06:57.460902"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Phone Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.461222"], ["number", "555-0003"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.461222"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/contacts/1" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#update as HTML
  Parameters: {"contact" => {"name" => "John Updated", "contact_relationships_attributes" => {"0" => {"id" => "1", "relation_type" => "friend", "related_contact_attributes" => {"id" => "2", "name" => "Alice Updated", "phones_attributes" => {"0" => {"id" => "1", "number" => "555-UPDATED"}}}}}}, "id" => "1"}
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
================================================================================
UPDATE PARAMS:
{"contact" => {"name" => "John Updated", "contact_relationships_attributes" => {"0" => {"id" => "1", "relation_type" => "friend", "related_contact_attributes" => {"id" => "2", "name" => "Alice Updated", "phones_attributes" => {"0" => {"id" => "1", "number" => "555-UPDATED"}}}}}}, "controller" => "contacts", "action" => "update", "id" => "1"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."id" = ?[0m  [["contact_id", 1], ["id", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ? AND "aeno_phones"."id" = ?[0m  [["contact_id", 2], ["id", 1]]
  [1m[36mAeno::Contact Update (0.0ms)[0m  [1m[33mUPDATE "aeno_contacts" SET "name" = ?, "updated_at" = ? WHERE "aeno_contacts"."id" = ?[0m  [["name", "John Updated"], ["updated_at", "2025-12-19 09:06:57.463690"], ["id", 1]]
  [1m[36mAeno::Contact Update (0.0ms)[0m  [1m[33mUPDATE "aeno_contacts" SET "name" = ?, "updated_at" = ? WHERE "aeno_contacts"."id" = ?[0m  [["name", "Alice Updated"], ["updated_at", "2025-12-19 09:06:57.464036"], ["id", 2]]
  [1m[36mAeno::Phone Update (0.0ms)[0m  [1m[33mUPDATE "aeno_phones" SET "number" = ?, "updated_at" = ? WHERE "aeno_phones"."id" = ?[0m  [["number", "555-UPDATED"], ["updated_at", "2025-12-19 09:06:57.464219"], ["id", 1]]
  [1m[36mAeno::ContactRelationship Update (0.0ms)[0m  [1m[33mUPDATE "aeno_contact_relationships" SET "relation_type" = ?, "updated_at" = ? WHERE "aeno_contact_relationships"."id" = ?[0m  [["relation_type", "friend"], ["updated_at", "2025-12-19 09:06:57.464358"], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact updated
Redirected to http://www.example.com/contacts/1
Completed 302 Found in 3ms (ActiveRecord: 0.2ms (8 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mAeno::Phone Load (0.0ms)[0m  [1m[34mSELECT "aeno_phones".* FROM "aeno_phones" WHERE "aeno_phones"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN deferred TRANSACTION[0m
---------------------------------------------------------------------
Aeno::ContactsControllerTest: test_should_accept_deeply_nested_arrays
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.465807"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "John Doe"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.465807"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/contacts" for 127.0.0.1 at 2025-12-19 10:06:57 +0100
Processing by ContactsController#create as HTML
  Parameters: {"contact" => {"name" => "Deep Array Test", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-MAIN", "phone_type" => "mobile"}], "contact_relationships_attributes" => [{"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Sibling Array", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-SIB-1", "phone_type" => "work"}, {"number" => "555-SIB-2", "phone_type" => "mobile"}]}}, {"relation_type" => "friend", "related_contact_attributes" => {"name" => "Friend Array", "email" => "[FILTERED]", "phones_attributes" => [{"number" => "555-FRD", "phone_type" => "mobile"}]}}]}}
================================================================================
RECEIVED PARAMS:
{"contact" => {"name" => "Deep Array Test", "email" => "deeparray@example.com", "phones_attributes" => [{"number" => "555-MAIN", "phone_type" => "mobile"}], "contact_relationships_attributes" => [{"relation_type" => "sibling", "related_contact_attributes" => {"name" => "Sibling Array", "email" => "sibarray@example.com", "phones_attributes" => [{"number" => "555-SIB-1", "phone_type" => "work"}, {"number" => "555-SIB-2", "phone_type" => "mobile"}]}}, {"relation_type" => "friend", "related_contact_attributes" => {"name" => "Friend Array", "email" => "friendarray@example.com", "phones_attributes" => [{"number" => "555-FRD", "phone_type" => "mobile"}]}}]}, "controller" => "contacts", "action" => "create"}
================================================================================
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAeno::Contact Create (0.1ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.467942"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Deep Array Test"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.467942"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.468217"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Sibling Array"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.468217"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:06:57.468395"], ["number", "555-SIB-1"], ["phone_type", "work"], ["updated_at", "2025-12-19 09:06:57.468395"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 3], ["created_at", "2025-12-19 09:06:57.468544"], ["number", "555-SIB-2"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.468544"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.468684"], ["related_contact_id", 3], ["relation_type", "sibling"], ["updated_at", "2025-12-19 09:06:57.468684"]]
  [1m[36mAeno::Contact Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contacts" ("address", "birth_date", "city", "company", "country", "created_at", "email", "job_title", "name", "notes", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["address", nil], ["birth_date", nil], ["city", nil], ["company", nil], ["country", nil], ["created_at", "2025-12-19 09:06:57.468841"], ["email", "[FILTERED]"], ["job_title", nil], ["name", "Friend Array"], ["notes", nil], ["updated_at", "2025-12-19 09:06:57.468841"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 4], ["created_at", "2025-12-19 09:06:57.469017"], ["number", "555-FRD"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.469017"]]
  [1m[36mAeno::ContactRelationship Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_contact_relationships" ("contact_id", "created_at", "related_contact_id", "relation_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.469143"], ["related_contact_id", 4], ["relation_type", "friend"], ["updated_at", "2025-12-19 09:06:57.469143"]]
  [1m[36mAeno::Phone Create (0.0ms)[0m  [1m[32mINSERT INTO "aeno_phones" ("contact_id", "created_at", "number", "phone_type", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["contact_id", 2], ["created_at", "2025-12-19 09:06:57.469289"], ["number", "555-MAIN"], ["phone_type", "mobile"], ["updated_at", "2025-12-19 09:06:57.469289"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
SUCCESS: Contact created with ID 2
  [1m[36mAeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
Relationships count: 2
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
Phones count: 1
Redirected to http://www.example.com/contacts/2
Completed 302 Found in 4ms (ActiveRecord: 0.3ms (11 queries, 0 cached) | GC: 0.0ms)
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."name" = ? LIMIT ?[0m  [["name", "Deep Array Test"], ["LIMIT", 1]]
  [1m[36mCACHE Aeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mCACHE Aeno::ContactRelationship Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ?[0m  [["contact_id", 2]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."relation_type" = ? LIMIT ?[0m  [["contact_id", 2], ["relation_type", "sibling"], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 3]]
  [1m[36mAeno::ContactRelationship Load (0.0ms)[0m  [1m[34mSELECT "aeno_contact_relationships".* FROM "aeno_contact_relationships" WHERE "aeno_contact_relationships"."contact_id" = ? AND "aeno_contact_relationships"."relation_type" = ? LIMIT ?[0m  [["contact_id", 2], ["relation_type", "friend"], ["LIMIT", 1]]
  [1m[36mAeno::Contact Load (0.0ms)[0m  [1m[34mSELECT "aeno_contacts".* FROM "aeno_contacts" WHERE "aeno_contacts"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mAeno::Phone Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "aeno_phones" WHERE "aeno_phones"."contact_id" = ?[0m  [["contact_id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
